| **Service**               | **Key APIs / Endpoints**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | **Database(s) Used**                                                                                                                          | **Data Stored**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| ------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Auth Service**          | • `POST /auth/register`  – Create new user<br>• `POST /auth/login`  – Authenticate & issue JWT<br>• `POST /auth/refresh`  – Refresh JWT<br>• `POST /auth/logout`  – Revoke refresh token<br>• `GET /auth/me`  – Get current user profile (via JWT)                                                                                                                                                                                                                                                                                           | **PostgreSQL 14+**<br>(auth-db)                                                                                                               | • `users` ( user\_id, username, email, password\_hash, full\_name, phone\_number, is\_active, created\_at, updated\_at )<br>• `roles` ( role\_id, role\_name, description )<br>• `user_roles` ( user\_id ↔ role\_id, assigned\_at )<br>• `refresh_tokens` ( token\_id, user\_id, token, expires\_at, revoked, created\_at )<br>• `password_reset_requests` ( request\_id, user\_id, reset\_token, expires\_at, is\_used, created\_at )                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| **Account Service**       | • `GET /customers`  – List all customers<br>• `GET /customers/{id}`  – Fetch customer details<br>• `POST /customers`  – Create new customer<br>• `PUT /customers/{id}`  – Update customer data<br>• `GET /accounts/{id}`  – Fetch account metadata/balance<br>• `POST /accounts`  – Open new account<br>• `PUT /accounts/{id}`  – Update account status (e.g., freeze/close)<br>• `GET /accounts/{id}/balance`  – Current balance<br>• `GET /accounts/{id}/settings`  – Fetch per-account config                                             | **PostgreSQL 14+**<br>(account-db)                                                                                                            | • `customers` ( customer\_id, first\_name, last\_name, date\_of\_birth, email, phone\_number, address (JSONB), kyc\_status, kyc\_metadata (JSONB), created\_at, updated\_at )<br>• `accounts` ( account\_id, customer\_id → customers, account\_number, account\_type, currency, balance, status, opened\_at, closed\_at, updated\_at )<br>• `account_settings` ( account\_id → accounts, overdraft\_limit, daily\_withdrawal\_limit, notifications\_enabled )<br>• `account_logs` ( log\_id, account\_id → accounts, change\_type, old\_value (JSONB), new\_value (JSONB), changed\_by, change\_ts )                                                                                                                                                                                                                                                                               |
| **Transaction Service**   | • `POST /transactions/transfer`  – Transfer between accounts<br>• `GET /transactions/{id}`  – Fetch single transaction<br>• `GET /accounts/{id}/transactions`  – List paged transactions for account<br>• `GET /transactions?status={status}&date_from={…}&…`  – Filtered search                                                                                                                                                                                                                                                             | **PostgreSQL 14+**<br>(transaction-db)<br>**Redis**<br>(distributed locks, “pending” flags)<br>**Kafka / RabbitMQ**<br>(for event publishing) | • `transactions` ( transaction\_id, account\_id → accounts, related\_account\_id → accounts, transaction\_type, amount, currency, status, created\_at, completed\_at, description, metadata (JSONB) )<br>• `transaction_audit` ( audit\_id, transaction\_id → transactions, audit\_event, old\_status, new\_status, changed\_by, event\_ts )<br>• `transaction_balance_snapshot` ( snapshot\_id, account\_id → accounts, balance\_snapshot, snapshot\_ts )<br>• **Redis** stores ephemeral locks keyed by `lock:acct:{account_id}` during in-flight transfers                                                                                                                                                                                                                                                                                                                       |
| **Payment Service**       | • `POST /payments`  – Initiate one-off payment (ACH/Wire/Card)<br>• `GET /payments/{id}`  – Fetch payment status<br>• `GET /accounts/{id}/payments`  – List payments for an account<br>• `POST /payments/schedule`  – Create/Update scheduled payment<br>• `GET /payments/scheduled/{schedule_id}`  – Fetch schedule<br>• `DELETE /payments/schedule/{schedule_id}`  – Cancel schedule                                                                                                                                                       | **PostgreSQL 14+**<br>(payment-db)<br>**Redis**<br>(idempotency, rate-limiting)<br>**Kafka / RabbitMQ**<br>(event publishing)                 | • `payments` ( payment\_id, account\_id → accounts, external\_reference (unique), payment\_method, amount, currency, status, initiated\_at, completed\_at, metadata (JSONB) )<br>• `payment_attempts` ( attempt\_id, payment\_id → payments, attempt\_ts, status, response\_code, response\_message )<br>• `scheduled_payments` ( schedule\_id, account\_id → accounts, amount, currency, frequency, next\_run\_date, end\_date, is\_active, created\_at, updated\_at )<br>• **Redis** stores idempotency keys keyed by `payment:idempotency:{account_id}:{external_reference}`                                                                                                                                                                                                                                                                                                     |
| **Loan & Credit Service** | • `POST /loans/apply`  – Submit new loan application<br>• `GET /loans/applications/{id}`  – Fetch application<br>• `GET /loans/customers/{customer_id}/applications`  – List customer’s applications<br>• `GET /loans/{loan_id}`  – Fetch active loan account<br>• `GET /loans/{loan_id}/payments`  – Payment schedule/status<br>• `POST /loans/{loan_id}/pay`  – Make a loan installment payment<br>• `GET /creditscore/{customer_id}`  – Fetch latest credit score<br>• `GET /creditreports/{customer_id}`  – Fetch raw credit report JSON | **PostgreSQL 14+**<br>(loan-db)<br>**Redis**<br>(ML feature cache)<br>**Kafka / RabbitMQ**<br>(event publishing)                              | • `loan_applications` ( application\_id, customer\_id → customers, amount\_requested, term\_months, purpose, status, submitted\_at, reviewed\_at, decision\_by )<br>• `loan_accounts` ( loan\_id, application\_id → loan\_applications, customer\_id → customers, principal\_amount, outstanding\_balance, interest\_rate, start\_date, end\_date, status, created\_at, updated\_at )<br>• `loan_payments` ( payment\_id, loan\_id → loan\_accounts, due\_date, payment\_amount, paid\_amount, paid\_date, status )<br>• `credit_reports` ( report\_id, customer\_id → customers, report\_source, fetched\_at, report\_data (JSONB) )<br>• `loan_decision_logs` ( log\_id, application\_id → loan\_applications, decision, decision\_by, decision\_score, comments, decision\_ts )<br>• **Redis** key `loan:features:{customer_id}` holds serialized feature vectors for ML scoring |
| **Chatbot Service**       | • `POST /chat/start`  – Begin new conversation (returns conversation\_id)<br>• `POST /chat/message`  – Send user message, get bot response<br>• `GET /chat/{conversation_id}/messages`  – List message history<br>• `GET /intents`  – List registered intents<br>• `POST /intents`  – Create/update intent training data<br>• `GET /embeddings/{text}`  – Return vector embedding for text (optional)                                                                                                                                        | **MongoDB Replica Set**<br>(chatbot-db)<br>**Redis**<br>(session state, rate-limiting)                                                        | • `conversations` ( \_id / conversation\_id, user\_id, started\_at, ended\_at, metadata )<br>• `messages` ( \_id / message\_id, conversation\_id → conversations, sender\_type (USER/BOT), message\_text, timestamp, nlp\_metadata (JSON) )<br>• `intents` ( \_id, name, training\_phrases \[ … ], response\_templates \[ … ], created\_at, updated\_at )<br>• `embeddings` ( \_id, text\_chunk, vector \[array of floats], created\_at )<br>• **Redis** stores ephemeral session context keyed by `session:{conversation_id}`                                                                                                                                                                                                                                                                                                                                                      |
| **Insights Service**      | • `GET /analytics/daily-summary?date={YYYY-MM-DD}`  – Daily txn/volume per branch<br>• `GET /analytics/transactions?start={…}&end={…}&branch_id={…}`  – Filtered TXN facts<br>• `GET /analytics/accounts-report?date={YYYY-MM-DD}`  – Account balance snapshots<br>• `GET /analytics/loans-report?start={…}&end={…}`  – Loan disbursal & payment stats<br>• `GET /analytics/customers-growth?start={…}&end={…}`  – New customer sign-ups                                                                                                     | **PostgreSQL 14+**<br>(analytics-db)<br> – Partitioned tables<br> – Materialized views (pg\_cron scheduled refresh)                           | • `dim_date` ( date\_id, year, quarter, month, day, day\_of\_week ) – prepopulated calendar table<br>• `dim_account` ( account\_id, customer\_id, account\_type, opened\_year, status ) – denormalized from `accounts`<br>• `dim_branch` ( branch\_id, branch\_name, region ) – if branch data exists<br>• `fact_transactions` ( transaction\_id, account\_id, branch\_id, date\_id, amount, transaction\_type, status ) – partitioned by `date_id`<br>• `fact_account_balance` ( snapshot\_id, account\_id, date\_id, balance ) – partitioned by `date_id`<br>• Materialized views (e.g., `mv_daily_branch_summary`) storing pre‐aggregated metrics<br>• ETL logs / CDC offsets (internal tracking tables)                                                                                                                                                                         |
